import { expect, test } from '@jest/globals'
import type { ExplorerState } from '../src/parts/ExplorerState/ExplorerState.ts'
import { createDefaultState } from '../src/parts/CreateDefaultState/CreateDefaultState.ts'
import { getIndexFromPosition } from '../src/parts/GetIndexFromPosition/GetIndexFromPosition.ts'

test('getIndexFromPosition', () => {
  const state: ExplorerState = {
    ...createDefaultState(),
    uid: 44,
    parentUid: 43,
    root: 'test:///virtual-dom',
    items: [
      {
        depth: 1,
        posInSet: 1,
        setSize: 19,
        icon: '',
        name: '.git',
        path: 'test:///virtual-dom/.git',
        type: 3,
        selected: false,
      },
      {
        depth: 1,
        posInSet: 2,
        setSize: 19,
        icon: '',
        name: '.github',
        path: 'test:///virtual-dom/.github',
        type: 3,
        selected: false,
      },
      {
        depth: 1,
        posInSet: 3,
        setSize: 19,
        icon: '',
        name: '.vscode',
        path: 'test:///virtual-dom/.vscode',
        type: 3,
        selected: false,
      },
      {
        depth: 1,
        posInSet: 4,
        setSize: 19,
        icon: '',
        name: 'dist',
        path: 'test:///virtual-dom/dist',
        type: 3,
        selected: false,
      },
      {
        depth: 1,
        posInSet: 5,
        setSize: 19,
        icon: '',
        name: 'node_modules',
        path: 'test:///virtual-dom/node_modules',
        type: 3,
        selected: false,
      },
      {
        depth: 1,
        posInSet: 6,
        setSize: 19,
        icon: '',
        name: 'packages',
        path: 'test:///virtual-dom/packages',
        type: 3,
        selected: false,
      },
      {
        depth: 1,
        posInSet: 7,
        setSize: 19,
        icon: '',
        name: 'scripts',
        path: 'test:///virtual-dom/scripts',
        type: 3,
        selected: false,
      },
      {
        depth: 1,
        posInSet: 8,
        setSize: 19,
        icon: '',
        name: 'virtual-dom-worker',
        path: 'test:///virtual-dom/virtual-dom-worker',
        type: 3,
        selected: false,
      },
      {
        depth: 1,
        posInSet: 9,
        setSize: 19,
        icon: '',
        name: '.gitignore',
        path: 'test:///virtual-dom/.gitignore',
        type: 7,
        selected: false,
      },
      {
        depth: 1,
        posInSet: 10,
        setSize: 19,
        icon: '',
        name: '.gitpod.Dockerfile',
        path: 'test:///virtual-dom/.gitpod.Dockerfile',
        type: 7,
        selected: false,
      },
      {
        depth: 1,
        posInSet: 11,
        setSize: 19,
        icon: '',
        name: '.gitpod.yml',
        path: 'test:///virtual-dom/.gitpod.yml',
        type: 7,
        selected: false,
      },
      {
        depth: 1,
        posInSet: 12,
        setSize: 19,
        icon: '',
        name: '.nvmrc',
        path: 'test:///virtual-dom/.nvmrc',
        type: 7,
        selected: false,
      },
      {
        depth: 1,
        posInSet: 13,
        setSize: 19,
        icon: '',
        name: 'LICENSE',
        path: 'test:///virtual-dom/LICENSE',
        type: 7,
        selected: false,
      },
      {
        depth: 1,
        posInSet: 14,
        setSize: 19,
        icon: '',
        name: 'README.md',
        path: 'test:///virtual-dom/README.md',
        type: 7,
        selected: false,
      },
      {
        depth: 1,
        posInSet: 15,
        setSize: 19,
        icon: '',
        name: 'eslint.config.js',
        path: 'test:///virtual-dom/eslint.config.js',
        type: 7,
        selected: false,
      },
      {
        depth: 1,
        posInSet: 16,
        setSize: 19,
        icon: '',
        name: 'lerna.json',
        path: 'test:///virtual-dom/lerna.json',
        type: 7,
        selected: false,
      },
      {
        depth: 1,
        posInSet: 17,
        setSize: 19,
        icon: '',
        name: 'package-lock.json',
        path: 'test:///virtual-dom/package-lock.json',
        type: 7,
        selected: false,
      },
      {
        depth: 1,
        posInSet: 18,
        setSize: 19,
        icon: '',
        name: 'package.json',
        path: 'test:///virtual-dom/package.json',
        type: 7,
        selected: false,
      },
      {
        depth: 1,
        posInSet: 19,
        setSize: 19,
        icon: '',
        name: 'tsconfig.json',
        path: 'test:///virtual-dom/tsconfig.json',
        type: 7,
        selected: false,
      },
    ],
    focusedIndex: 0,
    focused: false,
    hoverIndex: -1,
    x: 29,
    y: 1671,
    width: 170,
    height: 964,
    deltaY: 0,
    minLineY: 0,
    maxLineY: 19,
    pathSeparator: '/',
    version: 0,
    editingIndex: -1,
    itemHeight: 22,
    dropTargets: [],
    excluded: [],
    editingValue: '',
    editingType: 0,
    editingIcon: '',
    fileIconCache: {
      'test:///virtual-dom/.git': 'test://file-icons/folder_type_git.svg',
      'test:///virtual-dom/.github': 'test://file-icons/folder_type_github.svg',
      'test:///virtual-dom/.vscode': 'test://file-icons/folder_type_vscode.svg',
      'test:///virtual-dom/dist': 'test://file-icons/folder_type_dist.svg',
      'test:///virtual-dom/node_modules': 'test://file-icons/folder_type_node.svg',
      'test:///virtual-dom/packages': 'test://file-icons/folder_type_package.svg',
      'test:///virtual-dom/scripts': 'test://file-icons/folder_type_script.svg',
      'test:///virtual-dom/virtual-dom-worker': 'test://file-icons/default_folder.svg',
      'test:///virtual-dom/.gitignore': 'test://file-icons/file_type_git.svg',
      'test:///virtual-dom/.gitpod.Dockerfile': 'test://file-icons/file_type_docker.svg',
      'test:///virtual-dom/.gitpod.yml': 'test://file-icons/file_type_gitpod.svg',
      'test:///virtual-dom/.nvmrc': 'test://file-icons/file_type_node.svg',
      'test:///virtual-dom/LICENSE': 'test://file-icons/file_type_license.svg',
      'test:///virtual-dom/README.md': 'test://file-icons/file_type_markdown.svg',
      'test:///virtual-dom/eslint.config.js': 'test://file-icons/file_type_eslint.svg',
      'test:///virtual-dom/lerna.json': 'test://file-icons/file_type_lerna.svg',
      'test:///virtual-dom/package-lock.json': 'test://file-icons/file_type_npm.svg',
      'test:///virtual-dom/package.json': 'test://file-icons/file_type_npm.svg',
      'test:///virtual-dom/tsconfig.json': 'test://file-icons/file_type_tsconfig.svg',
      'test:///virtual-dom/.git/branches': 'test://file-icons/default_folder.svg',
      'test:///virtual-dom/.git/hooks': 'test://file-icons/folder_type_hook.svg',
      'test:///virtual-dom/.git/info': 'test://file-icons/default_folder.svg',
      'test:///virtual-dom/.git/logs': 'test://file-icons/folder_type_log.svg',
      'test:///virtual-dom/.git/objects': 'test://file-icons/default_folder.svg',
      'test:///virtual-dom/.git/refs': 'test://file-icons/default_folder.svg',
      'test:///virtual-dom/.git/rr-cache': 'test://file-icons/default_folder.svg',
      'test:///virtual-dom/.git/COMMIT_EDITMSG': 'test://file-icons/default_file.svg',
      'test:///virtual-dom/.git/config': 'test://file-icons/default_file.svg',
      'test:///virtual-dom/.git/description': 'test://file-icons/default_file.svg',
      'test:///virtual-dom/.git/FETCH_HEAD': 'test://file-icons/default_file.svg',
      'test:///virtual-dom/.git/HEAD': 'test://file-icons/default_file.svg',
      'test:///virtual-dom/.git/index': 'test://file-icons/default_file.svg',
      'test:///virtual-dom/.git/ORIG_HEAD': 'test://file-icons/default_file.svg',
      'test:///virtual-dom/.git/packed-refs': 'test://file-icons/default_file.svg',
    },
    useChevrons: true,
    confirmDelete: false,
    icons: [
      'test://file-icons/folder_type_git.svg',
      'test://file-icons/folder_type_github.svg',
      'test://file-icons/folder_type_vscode.svg',
      'test://file-icons/folder_type_dist.svg',
      'test://file-icons/folder_type_node.svg',
      'test://file-icons/folder_type_package.svg',
      'test://file-icons/folder_type_script.svg',
      'test://file-icons/default_folder.svg',
      'test://file-icons/file_type_git.svg',
      'test://file-icons/file_type_docker.svg',
      'test://file-icons/file_type_gitpod.svg',
      'test://file-icons/file_type_node.svg',
      'test://file-icons/file_type_license.svg',
      'test://file-icons/file_type_markdown.svg',
      'test://file-icons/file_type_eslint.svg',
      'test://file-icons/file_type_lerna.svg',
      'test://file-icons/file_type_npm.svg',
      'test://file-icons/file_type_npm.svg',
      'test://file-icons/file_type_tsconfig.svg',
    ],
    platform: 2,
    focus: 0,
    editingErrorMessage: '',
    inputSource: 0,
    editingSelectionStart: 0,
    editingSelectionEnd: 0,
    focusWord: '',
    focusWordTimeout: 800,
    finalDeltaY: 0,
    handleOffset: 0,
    scrollBarActive: false,
    scrollBarHeight: 0,
    confirmPaste: false,
    pasteShouldMove: false,
    cutItems: [],
    isPointerDown: false,
    pointerDownIndex: -1,
    sourceControlIgnoredUris: [],
  }
  expect(getIndexFromPosition(state, 988, 1700)).toBe(1)
})
